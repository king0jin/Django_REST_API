# Django_REST_API
Django로 REST API 만들기


**pip install django**


**pip install djangorestframework**


**pip install mysqlclient**

## Djangoframework : Django와 다른 점
1. API 응답에서 HTTP 헤더에 대한 더 많은 세부정보를 설정하고 처리할 수 있다.
2. JSON과 같은 데이터 포맷으로 응답을 제공하여 클라이언트가 데이터를 쉽게 처리할 수 있도록 한다.
3. Serializer를 사용하여 복잡한 데이터 타입을 JSON, XML 등 다양한 포맷으로 변환할 수 있다

## 프로젝트와 애플리케이션 생성하기
### 프로젝트 생성
**django-admin startproject 프로젝트이름 경로**
+ 내가 설정한 프로젝트이름의 디렉토리와 manage.py가 생성된다.
### 애플리케이션 생성하기
**python manage.py startapp 애플리케이션이름**
+ 내가 설정한 애플리케이션이름의 디렉토리가 생성된다.

## 실행하기
**python manage.py runserver IP주소:포트번호**
+ 포트번호를 생략하면 **8000**번으로 자동 설정된다.
+ 로컬에서 실행하여 접속할 시 IP주소는 **127.0.0.1**이다 
  + Chrome브라우저에 **127.0.0.1:8000**으로 검색하면 django화면을 볼 수 있다.

## settings.py
### 프로젝트 설정 파일
secret key, debug mode, 개발환경에서 수행되는 내용을 다르게 만들고 할 때 등등의 설정을 할 수 있다
+ INSTALLED_APPS
  + 사용할 패키지와 애플리케이션 기재
    + rest_framework
    + 애플리케이션이름 
+ DATABASE
  + 기본으로 sqlite3로 설정되어 있다
  + mysql설정으로 변경하여 데이터베이스를 연동한다
+ TIME_ZONE
  + Asia/Seoul로 수정한다

## 프로젝트의 역할
1. 프로젝트는 하나 이상의 웹 애플리케이션을 포함할 수 있다
2. 프로젝트 urls.py : 프로젝트 전체의 URL라우팅을 조정하는 역할을 한다
## 애플리케이션의 역할
1. 프로젝트를 구성하는 각 기능이 고유한 URL공간을 갖고 충돌을 방지한다
2. 애플리케이션 views.py : 요청 URL의 처리 함수를 정의한다
### 애플리케이션에 urls.py를 생성하는 이유
+ 프로젝트 하나의 urls.py에 URL을 정의하면 관리하기 어려움으로 애플리케이션 별로 urls.py를 생성하여 해당 애플리케이션 관련 URL을 관리, 수정 할 수 있다.


**프로젝트 urls.py에 include를 사용하여 각각의 애플리케이션 URL설정을 하여 인식할 수 있게 하면된다**

## Response
요청에 대한 응답 결과를 만들기 위한 클래스이다

응답 결과를 알려줄 때는 상태코드를 같이 전송해서 정상 처리여부를 알려주는 것이 좋다
+ status : 상태코드

## serializers.py
모델의 데이터를 JSON문자열로 변환해서 출력해준다

## Django REST Framework에서 제공하는 데코레이터 : @api_view
1. 허용할 HTTP메서드 목록을 지정할 수 있다
2. 요청 데이터에 대한 유효성 검사, 오류 처리 로직을 간단하게 작성할 수 있다 - 요청 데이터에 따른 서로 다른 로직 구
3. HTTP응답을 쉽게 반환할 수 있도록 해준다 - Response 객체를 사용하여 JSON형태로 응답을 반환
4. 기본 적인 권한, 인증 처리와 함께 사용할 수 있다

## AJAX - Asynchronous JavaScript and XML
웹페이지의 새로고침 없이 서버와 비동기적으로 데이터를 주고 받을 수 있는 기술
### 구현과정
1. XMLHttpRequest 인스턴스 생성
2. 이벤트 리스너 등록
3. 서버로 전송할 데이터 준비
4. 연결 요청 - open()
5. 요청 전송 - send()
6. 응답처리 - status확인
7. 결과로 화면 작업 수행 

#### JSON 파싱
JSON 형싱의 문자열을 자바스크립트 객체로 변환하는 작업
+ JSON.parse()메소드를 이용하여 문자열로 표현된 JSON 데이터를 객체로 변환하여 데이터의 개별 항목에 쉽게 접근할 수 있으므로 데이터를 좀 더 유용하게 사용할 수 있다
  + JSON 파싱으로 변경하기 전 : responseText를 단순히 문자열로 처리하여 화면에 표시만 했으므로 데이터를 개별 항목으로 접근하고 다루기가 어려웠다
  + JSON 파싱으로 변경한 후 : 데이터 항목을 개별 객체로 변현하여 특정 데이터에 접근도 할 수 있으며 다양한 처리가 가능하게 되었다  

## Fetch API
JavaScript에서 네트워크 요청을 처리할 수 있는 최신 기술
+ XMLHttpRequest보다 간단하고 강력한 기능을 제공한다
+ 서버와의 데이터 통신을 더 쉽게 할 수 있게 도와준다
+ 비동기 요청을 쉽게 이어서 수행할 수 있다 
### Fetch API 주요 구성 - fetch(주소, [옵션])
1. 주소 : 데이터를 가져오거나 보낼 API 주소
2. 옵션 : 요청방식(method), 헤더설정(headers), 전송할 데이터(body) 등의 요청
### Fetch API 기능
1. 응답처리
+ 종류 : response.json(), .text(), .blob() 등
  + response.json() : 추가 파싱 없이 바로 javaScript 객체로 변환할 수 있다
2. 비동기 처리
fetch는 Promise를 사용하므로 비동기 코드를 쉽게 작성할 수 있다
+ 종류 : .then(), .catch(), async/await 구문
  + then()메소드를 통해 응답을 받고 다음 작업을 체이닝으로 연결할 수 있다 

## axios
JavaScript와 Node.js에서 사용되는 HTTP 클라이언트 외부 라이브러리로 API와 비동기식 데이터 통신에 사용한다
+ 프로미스 기반이므로 .then(), .catch()로 비동기식 데이터 통신의 응답을 쉽게 다룰 수 있다
+ 개발자는 다양한 HTTP 요청을 쉽게 수행할 수 있으며, 서버와의 데이터 통신을 간단하고 직관적으로 처리할 수 있다
### axios 작동 방식
1. XMLHttpRequest 객체를 사용하여 요청을 서버로 전달한다
2. 서버는 전달 받은 객체를 기본 HTTP 모듈을 활용하여 요청을 처리한다
#### axios 라이브러리 사용할 시 주의할 점
+ 업데이트가 자주되는 라이브러리를 사용할 시 낮은 버전의 라이브러리를 사용하면 위험 요소가 따른다
  + 위험 요소 : 보안 취약성, 버그 및 성능 문제, 기능 호환성 문제, 지원 종료, 인터페이스 변화 등등

## 웹 클라이언트 애플리케이션
웹 브라우저에 내용을 출력하기 위한 애플리케이션 - 서버에서 제공하는 데이터를 클라이언트(사용자)에게 쉽게 이해하고 조직화 할 수 있도록 시작화해준다
+ HTML, CSS, JavaScript와 같은 웹 기술을 사용하여 개발한다
+ 클라이언트(사용자)와 서버 사이의 인터페이스 역할을 한다

## SOP (Same Origin Policy) : 동일 Origin(출처) 정책 - 웹 보안 정책
어떤 Origin에서 불러온 문서, 스크립트 등이 다른 Origin에서 가져온 리소스와 상호작용을 하려는 것을 제한하는 브라우저 보안 방식이다
+ SOP 목적 : 동일한 Origin에서 로드된 리소스끼리만 상호작용을 허용하여 브라우저 내의 데이터를 안전하게 보호
### SOP 적용O 
JavaScript를 이용해서 데이터를 가져오는 경우에 SOP가 적용된다
+ XMLHttpRequest를 사용하는 경우
+ Fetch API를 사용하는 경우
#### JavaScript를 이용해서 외부데이터를 가져오는 방법
방법1. 제공하는 측에서 CORS설정을 해주는 경우


방법2. 제공받는 측에서 Proxy Server를 이용해서 데이터를 가져오는 경우
+ react의 경우 설정 파일에 proxy설정을 하면 외부에서 데이터를 가져오는 것이 가능하다.

### SOP적용X
+ img태그로 이미지파일을 가져오는 경우
+ link태그로 css파일을 가져오는 경우
+ script태그로 javascript파일을 가져오는 경우
+ video, audio, object, embed, applet 태그를 이용해서 리소스를 가져오는 경우

## CORS (Cross-Origin Resource Sharing) : 교차 출처 정책 - 웹 보안 메커니즘
HTTP헤더를 사용하여 한 출처에서 실행 중인 웹 애플리케이션이 다른 출처의 자원에 접근할 수 있는 권한을 부여하도록 브라우저에게 알려주는 체제이다
+ 클라이언트와 서버가 다른 도메인에서 동작하는 현대 웹 애플리케이션 환경에서 필수적인 설정이다 

### CORS 동작 방식
서버가 HTTP응답 헤더에 특정 CORS 규칙을 추가하여 브라우저에게 접근 허용 여뷰를 알린다
1. 단순 요청 : 일반적인 HTTP메서드 사용하여 요청한다
2. 사전 확인 요청 : PUT, DELETE와 같은 민감한 메소드, 커스텀 헤더가 포함된 경우 브라우저는 사전 요청을 먼전 보내서 서버가 해당 요청을 허용하는 확인한다 

### CORS 설정 
+ 주로 서버에 설정한다 : XMLHttpRequest 나 Fetch API를 이용해서 서버의 데이터를 가져다가 사용할 수 있다
+ 프레임워크마다 웹 서버 마다 설정하는 방법은 다르다
  + Django: django-cors-headers 패키지를 통해 설정할 수 있습니다.

### CORS 필요 이유
현대의 프런트엔드와 백엔드가 다른 도메인에서 운영되는 경우, 클라이언트 애플리케이션이 API 서버에 안전하게 접근하기 위해 CORS 설정이 필수적이다.
+ 보안을 유지하면서도 교차 출처 요청을 허용하기 위해 만들어졌다.

### CORS 예외
모바일 애플리케이션 : 웹 브라우저 보안 모델에 따라 SOP, CORS제약을 받지 않기 때문에  CORS설정이 필요없다

### CORS 설정시 주의할 점
애플리케이션이 외부 리소스에 접근하지 못하거나, 보안 취약점이 발생할 수 있으므로 신중하게 설정



